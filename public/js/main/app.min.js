(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){


class Todo {

    update(id) {

        let form = $(`#task_form_${ id }`);
        var request = $.ajax({ url: 'todo/' + id, type: 'patch', data: form.serialize() });

        request.done(function (res) {
            $(`#task_span_${ id }`).html(res.task);
            $('#view_' + id).show();
            $('#edit_' + id).hide();
        });
    }

    editCancel(id) {
        let text = $('#task_span_' + id).html();
        $(`#task_input_${ id }`).val(text.trim());
        $('#edit_' + id).hide();
        $('#view_' + id).show();
    }

    edit(id) {
        let text = $('#task_span_' + id).html();
        $('#view_' + id).hide();
        $('#edit_' + id).show();
        $(`#task_input_${ id }`).val(text.trim()).select();
    }

    createCancel() {
        $('.task-create-cancel').hide();
        $('#task_0').remove();
        $('.task-create').show();
    }

    create() {
        $('.task-create-cancel').show();

        let token = $('#_token').val();

        let li = `<li id="task_0" class="collection-item">                    
                    <div id="edit_0" class="edit-mode">
                        <form id="task_form_0" class="col s10">
                            <input type="hidden" name="_token" value="${ token }">
                            <div class="row">
                                <div class="input-field col s10">
                                    <input placeholder="Enter task name" id="task_input_0"
                                           type="text" class="validate" name="task" 
                                            data-task-id="0">
                                </div>
                                <div class="col s2">
                                    <a href="javascript:void(0)" class="secondary-content task-store"
                                       data-task-id="0">
                                        <i class="medium material-icons">done</i>
                                    </a>
                                </div>
                            </div>

                        </form>
                        
                    </div>
                </li>`;

        $('#todo-list').append(li);
        $('#task_0').find('#task_input_0').focus();
    }

    store() {
        let form_data = $('#task_form_0').serialize();
        let url = this.getActivePage() ? `todo?page=${ this.getActivePage() }` : 'todo';
        let request = $.ajax({ url: url, type: 'post', data: form_data });
        let self = this;
        request.done(function (res) {
            self.renderTodo(res);
            $('.task-create-cancel').hide();
            $('.task-create').show();
        });
    }

    getActivePage() {
        let container = $('.pagination');
        let active = container.find('li.active');
        return container.length && active.length ? active.find('span').html().trim() : null;
    }

    deleteDialog(id) {
        let modal = $('#modal-task-delete');
        let task = $(`#task_span_${ id }`);

        $(`#task_${ id }`).addClass('red accent-1');

        modal.data('target-id', id);
        modal.find('#task-to-delete-text').html(task.html().trim());
        modal.openModal();
    }

    deleteCancel() {
        let modal = $('#modal-task-delete');
        let id = modal.data('target-id');
        $(`#task_${ id }`).removeClass('red accent-1');
        modal.closeModal();
    }

    delete() {
        let modal = $('#modal-task-delete');
        let id = modal.data('target-id');
        let url = this.getActivePage() ? `todo/${ id }?page=${ this.getActivePage() }` : `todo/${ id }`;
        let request = $.ajax({ url: url, type: 'delete', data: { _token: $('#_token').val() } });
        let self = this;

        request.done(function (res) {
            modal.closeModal();
            self.renderTodo(res);
        });
    }

    renderTodo(res) {
        let list = $('#todo-list');
        let collection = list.find('li:eq(0)').prop('outerHTML');
        list.empty();

        if (res.data.length) {
            for (let i in res.data) {
                collection += this.li(res.data[i]);
            }

            list.append(collection);
            this.renderPagination(res);
        } else {
            list.append(collection);
            list.append(`<li class="collection-item grey lighten-4 grey-text">
                        [ Add Your first Task ]
                        </li>`);
        }
    }

    renderPagination(res) {
        let pagination = '';

        if (!$('.pagination').length && res.data.length) {
            console.log('create pagination ul');
            $('#pagination-container').append(`<ul class="pagination"></ul>`);
        }

        let container = $('.pagination');

        if (res.data.length) {

            container.empty();

            if (res.last_page > 1) {

                let url = location.protocol + "//" + location.host;

                let prev = res.prev_page_url === null ? `<li><span> << </span></li>` : `<li><a href="${ res.prev_page_url }"> << </a></li>`;

                let next = res.next_page_url === null ? `<li><span> >> </span></li>` : `<li><a href="${ res.next_page_url }"> >> </a></li>`;

                pagination += prev;

                for (let i = 1; i <= res.last_page; i++) {

                    let li = `<li><a href="${ url }?page=${ i }">${ i }</a></li>`;

                    if (res.current_page == i) {
                        li = `<li class="active"><span class="active">${ i }</span></li>`;
                    }

                    pagination += li;
                }

                pagination += next;
                container.append(pagination);
            }
        }
    }

    li(res) {
        let token = $('#_token').val();

        return `<li id="task_${ res.id }" class="collection-item">
                    <div id="view_${ res.id }" class="view-mode">
                        <span id="task_span_${ res.id }">${ res.task }</span>
                        
                        <a href="javascript:void(0)" class="secondary-content task-delete-dialog
                            red-text text-accent-2"
                           data-task-id="${ res.id }" title="Delete Task">
                            <i class="material-icons">delete</i>
                        </a>
                        
                        <a href="javascript:void(0)" class="secondary-content task-edit"
                           data-task-id="${ res.id }">
                            <i class="material-icons">mode_edit</i>
                        </a>
                    </div>
                    
                    <div id="edit_${ res.id }" class="edit-mode" style="display: none">
                        <form id="task_form_${ res.id }" class="col s10">
                            <input type="hidden" name="_token" value="${ token }">
                            <div class="row">
                                <div class="input-field col s10">
                                    <input placeholder="Enter task name" id="task_input_${ res.id }"
                                           type="text" class="validate" name="task" 
                                           data-task-id="${ res.id }">
                                </div>
                                <div class="col s2">
                                <a href="javascript:void(0)" class="secondary-content 
                                        task-edit-cancel red-text text-accent-2" 
                                         data-task-id="${ res.id }">
                                        <i class="material-icons font-35">not_interested</i>
                                    </a>
                                    
                                    <a href="javascript:void(0)" class="secondary-content 
                                     task-update" data-task-id="${ res.id }">
                                        <i class="material-icons font-35">done</i>
                                    </a>
                                </div>
                            </div>

                        </form>

                    </div>
                </li>`;
    }

}

module.exports = new Todo();

},{}],2:[function(require,module,exports){
//$(".button-collapse").sideNav();

var Todo = require('../components/Todo');

$(document).on('click', '.task-create', function (e) {
    e.preventDefault();
    console.log('create');
    $('.task-create').hide();
    Todo.create();
});

$(document).on('click', '.task-create-cancel', function (e) {
    e.preventDefault();
    console.log('task-create-cancel');
    Todo.createCancel();
});

$(document).on('click', '.task-store', function (e) {
    e.preventDefault();
    console.log('create');
    Todo.store();
});

$(document).on("keypress", "input", function (e) {

    if (e.keyCode == 13) {
        e.preventDefault();
        let id = $(this).data('task-id');

        if ($('#task_0').length) {
            Todo.store();
        } else {
            Todo.update(id);
        }

        return false;
    } else if (e.keyCode == 27) {
        let id = $(this).data('task-id');
        if (id == 0) {
            Todo.createCancel();
        } else {
            Todo.editCancel(id);
        }
    }
});

$(document).on('click', '.task-edit', function (e) {
    e.preventDefault();
    console.log('edit');
    let id = $(this).data('task-id');
    Todo.edit(id);
});

$(document).on('click', '.task-edit-cancel', function (e) {
    e.preventDefault();
    console.log('edit-cancel');
    let id = $(this).data('task-id');
    Todo.editCancel(id);
});

$(document).on('click', '.task-update', function (e) {
    e.preventDefault();
    console.log('update');
    let id = $(this).data('task-id');
    Todo.update(id);
});

$(document).on('click', '.task-delete-dialog', function (e) {
    e.preventDefault();
    console.log('delete-dialog');
    let id = $(this).data('task-id');
    Todo.deleteDialog(id);
});

$(document).on('click', '.task-delete-cancel', function (e) {
    e.preventDefault();
    Todo.deleteCancel();
});

$(document).on('click', '.task-delete', function (e) {
    e.preventDefault();
    console.log('delete');
    Todo.delete();
});

$('main').on('click', '.pagination a', function (e) {
    $('.pagination').find('li').removeClass('active disabled');

    $(this).parent().addClass('active');
    getTodo($(this).attr('href').split('page=')[1]);
    e.preventDefault();
});

function getTodo(page) {
    $.ajax({
        url: 'todo?page=' + page,
        dataType: 'json'
    }).done(function (res) {
        Todo.renderTodo(res);
    }).fail(function () {
        alert('Posts could not be loaded.');
    });
}

$(document).ready(function () {
    $('.task-delete-dialog').leanModal({ dismissible: false });
});

},{"../components/Todo":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJyZXNvdXJjZXNcXGFzc2V0c1xcanNcXGNvbXBvbmVudHNcXFRvZG8uanMiLCJyZXNvdXJjZXNcXGFzc2V0c1xcanNcXG1haW5cXGluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNFQSxNQUFNLElBQU4sQ0FBVzs7QUFFUCxXQUFPLEVBQVAsRUFBVzs7QUFFUCxZQUFJLE9BQU8sRUFBRyxlQUFhLEVBQUcsR0FBbkIsQ0FBWDtBQUNBLFlBQUksVUFBVSxFQUFFLElBQUYsQ0FBTyxFQUFDLEtBQUssVUFBVSxFQUFoQixFQUFvQixNQUFNLE9BQTFCLEVBQW1DLE1BQU0sS0FBSyxTQUFMLEVBQXpDLEVBQVAsQ0FBZDs7QUFFQSxnQkFBUSxJQUFSLENBQWEsVUFBUyxHQUFULEVBQWE7QUFDdEIsY0FBRyxlQUFhLEVBQUcsR0FBbkIsRUFBc0IsSUFBdEIsQ0FBMkIsSUFBSSxJQUEvQjtBQUNBLGNBQUUsV0FBVyxFQUFiLEVBQWlCLElBQWpCO0FBQ0EsY0FBRSxXQUFXLEVBQWIsRUFBaUIsSUFBakI7QUFDSCxTQUpEO0FBT0g7O0FBRUQsZUFBVyxFQUFYLEVBQWU7QUFDWCxZQUFJLE9BQU8sRUFBRSxnQkFBZ0IsRUFBbEIsRUFBc0IsSUFBdEIsRUFBWDtBQUNBLFVBQUcsZ0JBQWMsRUFBRyxHQUFwQixFQUF1QixHQUF2QixDQUEyQixLQUFLLElBQUwsRUFBM0I7QUFDQSxVQUFFLFdBQVcsRUFBYixFQUFpQixJQUFqQjtBQUNBLFVBQUUsV0FBVyxFQUFiLEVBQWlCLElBQWpCO0FBQ0g7O0FBRUQsU0FBSyxFQUFMLEVBQVM7QUFDTCxZQUFJLE9BQU8sRUFBRSxnQkFBZ0IsRUFBbEIsRUFBc0IsSUFBdEIsRUFBWDtBQUNBLFVBQUUsV0FBVyxFQUFiLEVBQWlCLElBQWpCO0FBQ0EsVUFBRSxXQUFXLEVBQWIsRUFBaUIsSUFBakI7QUFDQSxVQUFHLGdCQUFjLEVBQUcsR0FB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QUFDQSxZQUFRLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsU0FBSyxNQUFMO0FBQ0gsQ0FKRDs7QUFPQSxFQUFFLE1BQUYsRUFBVSxFQUFWLENBQWEsT0FBYixFQUFzQixlQUF0QixFQUF1QyxVQUFVLENBQVYsRUFBYTtBQUNoRCxNQUFFLGFBQUYsRUFBaUIsSUFBakIsQ0FBc0IsSUFBdEIsRUFBNEIsV0FBNUIsQ0FBd0MsaUJBQXhDOztBQUVBLE1BQUUsSUFBRixFQUFRLE1BQVIsR0FBaUIsUUFBakIsQ0FBMEIsUUFBMUI7QUFDQSxZQUFRLEVBQUUsSUFBRixFQUFRLElBQVIsQ0FBYSxNQUFiLEVBQXFCLEtBQXJCLENBQTJCLE9BQTNCLEVBQW9DLENBQXBDLENBQVI7QUFDQSxNQUFFLGNBQUY7QUFDSCxDQU5EOztBQVFBLFNBQVMsT0FBVCxDQUFpQixJQUFqQixFQUF1QjtBQUNuQixNQUFFLElBQUYsQ0FBTztBQUNILGFBQU0sZUFBZSxJQURsQjtBQUVILGtCQUFVO0FBRlAsS0FBUCxFQUdHLElBSEgsQ0FHUSxVQUFVLEdBQVYsRUFBZTtBQUNuQixhQUFLLFVBQUwsQ0FBZ0IsR0FBaEI7QUFDSCxLQUxELEVBS0csSUFMSCxDQUtRLFlBQVk7QUFDaEIsY0FBTSw0QkFBTjtBQUNILEtBUEQ7QUFRSDs7QUFFRCxFQUFFLFFBQUYsRUFBWSxLQUFaLENBQWtCLFlBQVU7QUFDeEIsTUFBRSxxQkFBRixFQUF5QixTQUF6QixDQUFtQyxFQUFDLGFBQWEsS0FBZCxFQUFuQztBQUNILENBRkQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXHJcblxyXG5jbGFzcyBUb2RvIHtcclxuXHJcbiAgICB1cGRhdGUoaWQpIHtcclxuXHJcbiAgICAgICAgbGV0IGZvcm0gPSAkKGAjdGFza19mb3JtXyR7aWR9YCk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSAkLmFqYXgoe3VybDogJ3RvZG8vJyArIGlkLCB0eXBlOiAncGF0Y2gnLCBkYXRhOiBmb3JtLnNlcmlhbGl6ZSgpfSk7XHJcblxyXG4gICAgICAgIHJlcXVlc3QuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAkKGAjdGFza19zcGFuXyR7aWR9YCkuaHRtbChyZXMudGFzayk7XHJcbiAgICAgICAgICAgICQoJyN2aWV3XycgKyBpZCkuc2hvdygpO1xyXG4gICAgICAgICAgICAkKCcjZWRpdF8nICsgaWQpLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGVkaXRDYW5jZWwoaWQpIHtcclxuICAgICAgICBsZXQgdGV4dCA9ICQoJyN0YXNrX3NwYW5fJyArIGlkKS5odG1sKCk7XHJcbiAgICAgICAgJChgI3Rhc2tfaW5wdXRfJHtpZH1gKS52YWwodGV4dC50cmltKCkpO1xyXG4gICAgICAgICQoJyNlZGl0XycgKyBpZCkuaGlkZSgpO1xyXG4gICAgICAgICQoJyN2aWV3XycgKyBpZCkuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXQoaWQpIHtcclxuICAgICAgICBsZXQgdGV4dCA9ICQoJyN0YXNrX3NwYW5fJyArIGlkKS5odG1sKCk7XHJcbiAgICAgICAgJCgnI3ZpZXdfJyArIGlkKS5oaWRlKCk7XHJcbiAgICAgICAgJCgnI2VkaXRfJyArIGlkKS5zaG93KCk7XHJcbiAgICAgICAgJChgI3Rhc2tfaW5wdXRfJHtpZH1gKS52YWwodGV4dC50cmltKCkpLnNlbGVjdCgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjcmVhdGVDYW5jZWwoKSB7XHJcbiAgICAgICAgJCgnLnRhc2stY3JlYXRlLWNhbmNlbCcpLmhpZGUoKTtcclxuICAgICAgICAkKCcjdGFza18wJykucmVtb3ZlKCk7XHJcbiAgICAgICAgJCgnLnRhc2stY3JlYXRlJykuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICAkKCcudGFzay1jcmVhdGUtY2FuY2VsJykuc2hvdygpO1xyXG5cclxuICAgICAgICBsZXQgdG9rZW4gPSAkKCcjX3Rva2VuJykudmFsKCk7XHJcblxyXG4gICAgICAgIGxldCBsaSA9IGA8bGkgaWQ9XCJ0YXNrXzBcIiBjbGFzcz1cImNvbGxlY3Rpb24taXRlbVwiPiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cImVkaXRfMFwiIGNsYXNzPVwiZWRpdC1tb2RlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxmb3JtIGlkPVwidGFza19mb3JtXzBcIiBjbGFzcz1cImNvbCBzMTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIl90b2tlblwiIHZhbHVlPVwiJHt0b2tlbn1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZmllbGQgY29sIHMxMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgcGxhY2Vob2xkZXI9XCJFbnRlciB0YXNrIG5hbWVcIiBpZD1cInRhc2tfaW5wdXRfMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiIGNsYXNzPVwidmFsaWRhdGVcIiBuYW1lPVwidGFza1wiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIjBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sIHMyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBjbGFzcz1cInNlY29uZGFyeS1jb250ZW50IHRhc2stc3RvcmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRhc2staWQ9XCIwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1lZGl1bSBtYXRlcmlhbC1pY29uc1wiPmRvbmU8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvbGk+YDtcclxuXHJcblxyXG4gICAgICAgICQoJyN0b2RvLWxpc3QnKS5hcHBlbmQobGkpO1xyXG4gICAgICAgICQoJyN0YXNrXzAnKS5maW5kKCcjdGFza19pbnB1dF8wJykuZm9jdXMoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc3RvcmUoKSB7XHJcbiAgICAgICAgbGV0IGZvcm1fZGF0YSA9ICQoJyN0YXNrX2Zvcm1fMCcpLnNlcmlhbGl6ZSgpO1xyXG4gICAgICAgIGxldCB1cmwgPSAodGhpcy5nZXRBY3RpdmVQYWdlKCkpID8gYHRvZG8/cGFnZT0ke3RoaXMuZ2V0QWN0aXZlUGFnZSgpfWAgOiAndG9kbyc7XHJcbiAgICAgICAgbGV0IHJlcXVlc3QgPSAkLmFqYXgoe3VybDogdXJsLCB0eXBlOiAncG9zdCcsIGRhdGE6IGZvcm1fZGF0YX0pO1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICByZXF1ZXN0LmRvbmUoZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgc2VsZi5yZW5kZXJUb2RvKHJlcyk7XHJcbiAgICAgICAgICAgICQoJy50YXNrLWNyZWF0ZS1jYW5jZWwnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy50YXNrLWNyZWF0ZScpLnNob3coKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRBY3RpdmVQYWdlKCkge1xyXG4gICAgICAgIGxldCBjb250YWluZXIgPSAkKCcucGFnaW5hdGlvbicpO1xyXG4gICAgICAgIGxldCBhY3RpdmUgPSBjb250YWluZXIuZmluZCgnbGkuYWN0aXZlJyk7XHJcbiAgICAgICAgcmV0dXJuIChjb250YWluZXIubGVuZ3RoICYmIGFjdGl2ZS5sZW5ndGgpID8gYWN0aXZlLmZpbmQoJ3NwYW4nKS5odG1sKCkudHJpbSgpIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVEaWFsb2coaWQpIHtcclxuICAgICAgICBsZXQgbW9kYWwgPSAkKCcjbW9kYWwtdGFzay1kZWxldGUnKTtcclxuICAgICAgICBsZXQgdGFzayA9ICQoYCN0YXNrX3NwYW5fJHtpZH1gKTtcclxuXHJcbiAgICAgICAgJChgI3Rhc2tfJHtpZH1gKS5hZGRDbGFzcygncmVkIGFjY2VudC0xJyk7XHJcblxyXG4gICAgICAgIG1vZGFsLmRhdGEoJ3RhcmdldC1pZCcsIGlkKTtcclxuICAgICAgICBtb2RhbC5maW5kKCcjdGFzay10by1kZWxldGUtdGV4dCcpLmh0bWwodGFzay5odG1sKCkudHJpbSgpKTtcclxuICAgICAgICBtb2RhbC5vcGVuTW9kYWwoKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYW5jZWwoKSB7XHJcbiAgICAgICAgbGV0IG1vZGFsID0gJCgnI21vZGFsLXRhc2stZGVsZXRlJyk7XHJcbiAgICAgICAgbGV0IGlkID0gbW9kYWwuZGF0YSgndGFyZ2V0LWlkJyk7XHJcbiAgICAgICAgJChgI3Rhc2tfJHtpZH1gKS5yZW1vdmVDbGFzcygncmVkIGFjY2VudC0xJyk7XHJcbiAgICAgICAgbW9kYWwuY2xvc2VNb2RhbCgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBkZWxldGUoKSB7XHJcbiAgICAgICAgbGV0IG1vZGFsID0gJCgnI21vZGFsLXRhc2stZGVsZXRlJyk7XHJcbiAgICAgICAgbGV0IGlkID0gbW9kYWwuZGF0YSgndGFyZ2V0LWlkJyk7XHJcbiAgICAgICAgbGV0IHVybCA9ICh0aGlzLmdldEFjdGl2ZVBhZ2UoKSkgPyBgdG9kby8ke2lkfT9wYWdlPSR7dGhpcy5nZXRBY3RpdmVQYWdlKCl9YFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogYHRvZG8vJHtpZH1gO1xyXG4gICAgICAgIGxldCByZXF1ZXN0ID0gJC5hamF4KHt1cmw6IHVybCwgdHlwZTogJ2RlbGV0ZScsIGRhdGE6IHtfdG9rZW46ICQoJyNfdG9rZW4nKS52YWwoKX19KTtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIHJlcXVlc3QuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICBtb2RhbC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgICAgICAgIHNlbGYucmVuZGVyVG9kbyhyZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclRvZG8ocmVzKSB7XHJcbiAgICAgICAgbGV0IGxpc3QgPSAkKCcjdG9kby1saXN0Jyk7XHJcbiAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBsaXN0LmZpbmQoJ2xpOmVxKDApJykucHJvcCgnb3V0ZXJIVE1MJyk7XHJcbiAgICAgICAgbGlzdC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gcmVzLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24gKz0gdGhpcy5saShyZXMuZGF0YVtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxpc3QuYXBwZW5kKGNvbGxlY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclBhZ2luYXRpb24ocmVzKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxpc3QuYXBwZW5kKGNvbGxlY3Rpb24pO1xyXG4gICAgICAgICAgICBsaXN0LmFwcGVuZChgPGxpIGNsYXNzPVwiY29sbGVjdGlvbi1pdGVtIGdyZXkgbGlnaHRlbi00IGdyZXktdGV4dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBbIEFkZCBZb3VyIGZpcnN0IFRhc2sgXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPmApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJQYWdpbmF0aW9uKHJlcykge1xyXG4gICAgICAgIGxldCBwYWdpbmF0aW9uID0gJyc7XHJcblxyXG4gICAgICAgIGlmICggISAkKCcucGFnaW5hdGlvbicpLmxlbmd0aCAmJiByZXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZSBwYWdpbmF0aW9uIHVsJyk7XHJcbiAgICAgICAgICAgICQoJyNwYWdpbmF0aW9uLWNvbnRhaW5lcicpLmFwcGVuZChgPHVsIGNsYXNzPVwicGFnaW5hdGlvblwiPjwvdWw+YClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjb250YWluZXIgPSAkKCcucGFnaW5hdGlvbicpO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgY29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzLmxhc3RfcGFnZSA+IDEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBsb2NhdGlvbi5ob3N0O1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBwcmV2ID0gKHJlcy5wcmV2X3BhZ2VfdXJsID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgID8gYDxsaT48c3Bhbj4gPDwgPC9zcGFuPjwvbGk+YFxyXG4gICAgICAgICAgICAgICAgICAgIDogYDxsaT48YSBocmVmPVwiJHtyZXMucHJldl9wYWdlX3VybH1cIj4gPDwgPC9hPjwvbGk+YDtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IChyZXMubmV4dF9wYWdlX3VybCA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICA/IGA8bGk+PHNwYW4+ID4+IDwvc3Bhbj48L2xpPmBcclxuICAgICAgICAgICAgICAgICAgICA6IGA8bGk+PGEgaHJlZj1cIiR7cmVzLm5leHRfcGFnZV91cmx9XCI+ID4+IDwvYT48L2xpPmA7XHJcblxyXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbiArPSBwcmV2O1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHJlcy5sYXN0X3BhZ2U7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgbGkgPSBgPGxpPjxhIGhyZWY9XCIke3VybH0/cGFnZT0ke2l9XCI+JHtpfTwvYT48L2xpPmA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMuY3VycmVudF9wYWdlID09IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGkgPSBgPGxpIGNsYXNzPVwiYWN0aXZlXCI+PHNwYW4gY2xhc3M9XCJhY3RpdmVcIj4ke2l9PC9zcGFuPjwvbGk+YDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb24gKz0gbGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbiArPSBuZXh0O1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZChwYWdpbmF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsaSAocmVzKSB7XHJcbiAgICAgICAgbGV0IHRva2VuID0gJCgnI190b2tlbicpLnZhbCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gYDxsaSBpZD1cInRhc2tfJHtyZXMuaWR9XCIgY2xhc3M9XCJjb2xsZWN0aW9uLWl0ZW1cIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPVwidmlld18ke3Jlcy5pZH1cIiBjbGFzcz1cInZpZXctbW9kZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD1cInRhc2tfc3Bhbl8ke3Jlcy5pZH1cIj4ke3Jlcy50YXNrfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBjbGFzcz1cInNlY29uZGFyeS1jb250ZW50IHRhc2stZGVsZXRlLWRpYWxvZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkLXRleHQgdGV4dC1hY2NlbnQtMlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIiR7cmVzLmlkfVwiIHRpdGxlPVwiRGVsZXRlIFRhc2tcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5kZWxldGU8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBjbGFzcz1cInNlY29uZGFyeS1jb250ZW50IHRhc2stZWRpdFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIiR7cmVzLmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPm1vZGVfZWRpdDwvaT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJlZGl0XyR7cmVzLmlkfVwiIGNsYXNzPVwiZWRpdC1tb2RlXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxmb3JtIGlkPVwidGFza19mb3JtXyR7cmVzLmlkfVwiIGNsYXNzPVwiY29sIHMxMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiX3Rva2VuXCIgdmFsdWU9XCIke3Rva2VufVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInJvd1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dC1maWVsZCBjb2wgczEwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIkVudGVyIHRhc2sgbmFtZVwiIGlkPVwidGFza19pbnB1dF8ke3Jlcy5pZH1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIiBjbGFzcz1cInZhbGlkYXRlXCIgbmFtZT1cInRhc2tcIiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIiR7cmVzLmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wgczJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJzZWNvbmRhcnktY29udGVudCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2stZWRpdC1jYW5jZWwgcmVkLXRleHQgdGV4dC1hY2NlbnQtMlwiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIiR7cmVzLmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBmb250LTM1XCI+bm90X2ludGVyZXN0ZWQ8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBjbGFzcz1cInNlY29uZGFyeS1jb250ZW50IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay11cGRhdGVcIiBkYXRhLXRhc2staWQ9XCIke3Jlcy5pZH1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgZm9udC0zNVwiPmRvbmU8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvbGk+YDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IFRvZG87IiwiLy8kKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5zaWRlTmF2KCk7XHJcblxyXG52YXIgVG9kbyA9IHJlcXVpcmUoJy4uL2NvbXBvbmVudHMvVG9kbycpO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLWNyZWF0ZScsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ2NyZWF0ZScpO1xyXG4gICAgJCgnLnRhc2stY3JlYXRlJykuaGlkZSgpO1xyXG4gICAgVG9kby5jcmVhdGUoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stY3JlYXRlLWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ3Rhc2stY3JlYXRlLWNhbmNlbCcpO1xyXG4gICAgVG9kby5jcmVhdGVDYW5jZWwoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stc3RvcmUnLCBmdW5jdGlvbihlKXtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnNvbGUubG9nKCdjcmVhdGUnKTtcclxuICAgIFRvZG8uc3RvcmUoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbihcImtleXByZXNzXCIsIFwiaW5wdXRcIiwgZnVuY3Rpb24oZSkge1xyXG5cclxuICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgbGV0IGlkID0gJCh0aGlzKS5kYXRhKCd0YXNrLWlkJyk7XHJcblxyXG4gICAgICAgIGlmICgkKCcjdGFza18wJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIFRvZG8uc3RvcmUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBUb2RvLnVwZGF0ZShpZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAyNykge1xyXG4gICAgICAgIGxldCBpZCA9ICQodGhpcykuZGF0YSgndGFzay1pZCcpO1xyXG4gICAgICAgIGlmIChpZCA9PSAwKSB7XHJcbiAgICAgICAgICAgIFRvZG8uY3JlYXRlQ2FuY2VsKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgVG9kby5lZGl0Q2FuY2VsKGlkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KTtcclxuXHJcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudGFzay1lZGl0JywgZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZygnZWRpdCcpO1xyXG4gICAgbGV0IGlkID0gJCh0aGlzKS5kYXRhKCd0YXNrLWlkJyk7XHJcbiAgICBUb2RvLmVkaXQoaWQpO1xyXG59KTtcclxuXHJcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudGFzay1lZGl0LWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ2VkaXQtY2FuY2VsJyk7XHJcbiAgICBsZXQgaWQgPSAkKHRoaXMpLmRhdGEoJ3Rhc2staWQnKTtcclxuICAgIFRvZG8uZWRpdENhbmNlbChpZCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLXVwZGF0ZScsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ3VwZGF0ZScpO1xyXG4gICAgbGV0IGlkID0gJCh0aGlzKS5kYXRhKCd0YXNrLWlkJyk7XHJcbiAgICBUb2RvLnVwZGF0ZShpZCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLWRlbGV0ZS1kaWFsb2cnLCBmdW5jdGlvbihlKXtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnNvbGUubG9nKCdkZWxldGUtZGlhbG9nJyk7XHJcbiAgICBsZXQgaWQgPSAkKHRoaXMpLmRhdGEoJ3Rhc2staWQnKTtcclxuICAgIFRvZG8uZGVsZXRlRGlhbG9nKGlkKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stZGVsZXRlLWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgVG9kby5kZWxldGVDYW5jZWwoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stZGVsZXRlJywgZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZygnZGVsZXRlJyk7XHJcbiAgICBUb2RvLmRlbGV0ZSgpO1xyXG59KTtcclxuXHJcblxyXG4kKCdtYWluJykub24oJ2NsaWNrJywgJy5wYWdpbmF0aW9uIGEnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgJCgnLnBhZ2luYXRpb24nKS5maW5kKCdsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUgZGlzYWJsZWQnKTtcclxuXHJcbiAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgIGdldFRvZG8oJCh0aGlzKS5hdHRyKCdocmVmJykuc3BsaXQoJ3BhZ2U9JylbMV0pO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGdldFRvZG8ocGFnZSkge1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgICB1cmwgOiAndG9kbz9wYWdlPScgKyBwYWdlLFxyXG4gICAgICAgIGRhdGFUeXBlOiAnanNvbidcclxuICAgIH0pLmRvbmUoZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgIFRvZG8ucmVuZGVyVG9kbyhyZXMpO1xyXG4gICAgfSkuZmFpbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYWxlcnQoJ1Bvc3RzIGNvdWxkIG5vdCBiZSBsb2FkZWQuJyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcclxuICAgICQoJy50YXNrLWRlbGV0ZS1kaWFsb2cnKS5sZWFuTW9kYWwoe2Rpc21pc3NpYmxlOiBmYWxzZX0pO1xyXG59KTsiXX0=
