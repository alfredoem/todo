(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){


class Todo {

    update(id) {

        let form = $(`#task_form_${ id }`);
        var request = $.ajax({ url: 'todo/' + id, type: 'patch', data: form.serialize() });

        request.done(function (res) {
            console.log(res);
            $(`#task_span_${ id }`).html(res.task);
            $('#view_' + id).show();
            $('#edit_' + id).hide();
        });
    }

    editCancel(id) {
        let text = $('#task_span_' + id).html();
        $(`#task_input_${ id }`).val(text.trim());
        $('#edit_' + id).hide();
        $('#view_' + id).show();
    }

    edit(id) {
        let text = $('#task_span_' + id).html();
        console.log('Aloha!');
        $('#view_' + id).hide();
        $('#edit_' + id).show();
        $(`#task_input_${ id }`).val(text.trim()).select();
    }

    createCancel() {
        $('#task_0').remove();
        $('.task-create').show();
    }

    create() {
        $('.task-create-cancel').show();

        let token = $('#_token').val();

        let li = `<li id="task_0" class="collection-item">                    
                    <div id="edit_0" class="edit-mode">
                        <form id="task_form_0" class="col s10">
                            <input type="hidden" name="_token" value="${ token }">
                            <div class="row">
                                <div class="input-field col s10">
                                    <input placeholder="Enter task name" id="task_input_0"
                                           type="text" class="validate" name="task" 
                                            data-task-id="0">
                                </div>
                                <div class="col s2">
                                    <a href="javascript:void(0)" class="secondary-content task-store"
                                       data-task-id="0">
                                        <i class="medium material-icons">done</i>
                                    </a>
                                </div>
                            </div>

                        </form>
                        
                    </div>
                </li>`;

        $('#todo-list').append(li);
        $('#task_0').find('#task_input_0').focus();
    }

    store() {
        let form = $('#task_form_0');
        var request = $.ajax({ url: 'todo', type: 'post', data: form.serialize() });

        request.done(function (res) {
            location.reload();

            /*let task = $('#task_0');
            let token = $('#_token').val();
            task.remove();*/

            /*let li = `<li id="task_${res.id}" class="collection-item">
                    <div id="view_${res.id}" class="view-mode">
                        <span id="task_span_${res.id}">${res.task}</span>
                        
                        <a href="javascript:void(0)" class="secondary-content task-delete-dialog
                            red-text text-accent-2"
                           data-task-id="${res.id}" title="Delete Task">
                            <i class="material-icons">delete</i>
                        </a>
                        
                        <a href="javascript:void(0)" class="secondary-content task-edit"
                           data-task-id="${res.id}">
                            <i class="material-icons">mode_edit</i>
                        </a>
                    </div>
                    
                    <div id="edit_${res.id}" class="edit-mode" style="display: none">
                        <form id="task_form_${res.id}" class="col s10">
                            <input type="hidden" name="_token" value="${token}">
                            <div class="row">
                                <div class="input-field col s10">
                                    <input placeholder="Enter task name" id="task_input_${res.id}"
                                           type="text" class="validate" name="task" 
                                           data-task-id="${res.id}">
                                </div>
                                <div class="col s2">
                                    <a href="javascript:void(0)" class="secondary-content task-update"
                                       data-task-id="${res.id}">
                                        <i class="medium material-icons">done</i>
                                    </a>
                                </div>
                            </div>
                          </form>
                      </div>
                </li>`;
              let list = $('#todo-list');
              list.find('li:eq(0)').after(li);
              if (list.find('li').length == 9) {
                list.find('li').last().remove();
            }
              $('.task-create-cancel').hide();
            $('.task-create').show();*/
        });
    }

    deleteDialog(id) {
        let modal = $('#modal-task-delete');
        let task = $(`#task_span_${ id }`);

        $(`#task_${ id }`).addClass('red accent-1');

        modal.data('target-id', id);

        modal.find('#task-to-delete-text').html(task.html().trim());
        modal.openModal();
    }

    deleteCancel() {
        let modal = $('#modal-task-delete');
        let id = modal.data('target-id');
        $(`#task_${ id }`).removeClass('red accent-1');
        modal.closeModal();
    }

    delete() {
        let modal = $('#modal-task-delete');
        let id = modal.data('target-id');
        let request = $.ajax({ url: `todo/${ id }`, type: 'delete', data: { _token: $('#_token').val() } });
        request.done(function (res) {
            location.reload();
        });
    }

    renderTodo(res) {
        console.log('render');
        let list = $('#todo-list');
        let collection = list.find('li:eq(0)').prop('outerHTML');
        list.empty();

        for (let i in res.data) {
            collection += this.li(res.data[i]);
        }

        list.append(collection);
        this.renderPagination(res);
    }

    renderPagination(res) {
        let pagination = '';
        let container = $('.pagination');
        let url = location.protocol + "//" + location.host;

        let prev = res.prev_page_url === null ? `<li><span> << </span></li>` : `<li><a href="${ res.prev_page_url }"> << </a></li>`;

        let next = res.next_page_url === null ? `<li><span> >> </span></li>` : `<li><a href="${ res.next_page_url }"> >> </a></li>`;

        pagination += prev;

        for (let i = 1; i <= res.last_page; i++) {

            let li = `<li><a href="${ url }?page=${ i }" >${ i }</a></li>`;

            if (res.current_page == i) {
                li = `<li class="active"><span class="active">${ i }</span></li>`;
            }

            pagination += li;
        }

        pagination += next;

        console.log(`Current page: ${ res.current_page }`);

        container.empty().append(pagination);

        /*container.prepend(`<li><span> << </span></li>`);
        container.append(`<li><span> >> </span></li>`);*/
    }

    li(res) {
        let token = $('#_token').val();

        return `<li id="task_${ res.id }" class="collection-item">
                    <div id="view_${ res.id }" class="view-mode">
                        <span id="task_span_${ res.id }">${ res.task }</span>
                        
                        <a href="javascript:void(0)" class="secondary-content task-delete-dialog
                            red-text text-accent-2"
                           data-task-id="${ res.id }" title="Delete Task">
                            <i class="material-icons">delete</i>
                        </a>
                        
                        <a href="javascript:void(0)" class="secondary-content task-edit"
                           data-task-id="${ res.id }">
                            <i class="material-icons">mode_edit</i>
                        </a>
                    </div>
                    
                    <div id="edit_${ res.id }" class="edit-mode" style="display: none">
                        <form id="task_form_${ res.id }" class="col s10">
                            <input type="hidden" name="_token" value="${ token }">
                            <div class="row">
                                <div class="input-field col s10">
                                    <input placeholder="Enter task name" id="task_input_${ res.id }"
                                           type="text" class="validate" name="task" 
                                           data-task-id="${ res.id }">
                                </div>
                                <div class="col s2">
                                    <a href="javascript:void(0)" class="secondary-content task-update"
                                       data-task-id="${ res.id }">
                                        <i class="medium material-icons">done</i>
                                    </a>
                                </div>
                            </div>

                        </form>

                    </div>
                </li>`;
    }

}

module.exports = new Todo();

},{}],2:[function(require,module,exports){
//$(".button-collapse").sideNav();

var Todo = require('../components/Todo');

$(document).on('click', '.task-create', function (e) {
    e.preventDefault();
    console.log('create');
    $('.task-create').hide();
    Todo.create();
});

$(document).on('click', '.task-create-cancel', function (e) {
    e.preventDefault();
    console.log('task-create-cancel');
    $('.task-create-cancel').hide();
    Todo.createCancel();
});

$(document).on('click', '.task-store', function (e) {
    e.preventDefault();
    console.log('create');
    Todo.store();
});

$(document).on("keypress", "input", function (e) {

    if (e.keyCode == 13) {
        e.preventDefault();
        let id = $(this).data('task-id');

        if ($('#task_0').length) {

            console.log('I Could die for you');

            Todo.store();
        } else {
            Todo.update(id);
        }

        return false;
    }
});

$(document).on('click', '.task-edit', function (e) {
    e.preventDefault();
    console.log('edit');
    let id = $(this).data('task-id');
    Todo.edit(id);
});

$(document).on('click', '.task-edit-cancel', function (e) {
    e.preventDefault();
    console.log('edit-cancel');
    let id = $(this).data('task-id');
    Todo.editCancel(id);
});

$(document).on('click', '.task-update', function (e) {
    e.preventDefault();
    console.log('update');
    let id = $(this).data('task-id');
    Todo.update(id);
});

$(document).on('click', '.task-delete-dialog', function (e) {
    e.preventDefault();
    console.log('delete-dialog');
    let id = $(this).data('task-id');
    Todo.deleteDialog(id);
});

$(document).on('click', '.task-delete-cancel', function (e) {
    e.preventDefault();
    Todo.deleteCancel();
});

$(document).on('click', '.task-delete', function (e) {
    e.preventDefault();
    console.log('delete');
    Todo.delete();
});

$(function () {
    $('main').on('click', '.pagination a', function (e) {
        $('.pagination').find('li').removeClass('active disabled');

        $(this).parent().addClass('active');
        getTodo($(this).attr('href').split('page=')[1]);
        e.preventDefault();
    });
});

function getTodo(page) {
    $.ajax({
        url: '?page=' + page,
        dataType: 'json'
    }).done(function (res) {
        Todo.renderTodo(res);
    }).fail(function () {
        alert('Posts could not be loaded.');
    });
}

},{"../components/Todo":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJyZXNvdXJjZXNcXGFzc2V0c1xcanNcXGNvbXBvbmVudHNcXFRvZG8uanMiLCJyZXNvdXJjZXNcXGFzc2V0c1xcanNcXG1haW5cXGluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNFQSxNQUFNLElBQU4sQ0FBVzs7QUFFUCxXQUFPLEVBQVAsRUFBVzs7QUFFUCxZQUFJLE9BQU8sRUFBRyxlQUFhLEVBQUcsR0FBbkIsQ0FBWDtBQUNBLFlBQUksVUFBVSxFQUFFLElBQUYsQ0FBTyxFQUFDLEtBQUssVUFBVSxFQUFoQixFQUFvQixNQUFNLE9BQTFCLEVBQW1DLE1BQU0sS0FBSyxTQUFMLEVBQXpDLEVBQVAsQ0FBZDs7QUFFQSxnQkFBUSxJQUFSLENBQWEsVUFBUyxHQUFULEVBQWE7QUFDdEIsb0JBQVEsR0FBUixDQUFZLEdBQVo7QUFDQSxjQUFHLGVBQWEsRUFBRyxHQUFuQixFQUFzQixJQUF0QixDQUEyQixJQUFJLElBQS9CO0FBQ0EsY0FBRSxXQUFXLEVBQWIsRUFBaUIsSUFBakI7QUFDQSxjQUFFLFdBQVcsRUFBYixFQUFpQixJQUFqQjtBQUNILFNBTEQ7QUFRSDs7QUFFRCxlQUFXLEVBQVgsRUFBZTtBQUNYLFlBQUksT0FBTyxFQUFFLGdCQUFnQixFQUFsQixFQUFzQixJQUF0QixFQUFYO0FBQ0EsVUFBRyxnQkFBYyxFQUFHLEdBQXBCLEVBQXVCLEdBQXZCLENBQTJCLEtBQUssSUFBTCxFQUEzQjtBQUNBLFVBQUUsV0FBVyxFQUFiLEVBQWlCLElBQWpCO0FBQ0EsVUFBRSxXQUFXLEVBQWIsRUFBaUIsSUFBakI7QUFDSDs7QUFFRCxTQUFLLEVBQUwsRUFBUztBQUNMLFlBQUksT0FBTyxFQUFFLGdCQUFnQixFQUFsQixFQUFzQixJQUF0QixFQUFYO0FBQ0EsZ0JBQVEsR0FBUixDQUFZLFFBQVo7QUFDQSxVQUFFLFdBQVcsRUFBYixFQUFpQixJQUFqQjtBQUNB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QixjQUF4QixFQUF3QyxVQUFTLENBQVQsRUFBVztBQUMvQyxNQUFFLGNBQUY7QUFDQSxZQUFRLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsU0FBSyxNQUFMO0FBQ0gsQ0FKRDs7QUFNQSxFQUFFLFlBQVc7QUFDVCxNQUFFLE1BQUYsRUFBVSxFQUFWLENBQWEsT0FBYixFQUFzQixlQUF0QixFQUF1QyxVQUFVLENBQVYsRUFBYTtBQUNoRCxVQUFFLGFBQUYsRUFBaUIsSUFBakIsQ0FBc0IsSUFBdEIsRUFBNEIsV0FBNUIsQ0FBd0MsaUJBQXhDOztBQUVBLFVBQUUsSUFBRixFQUFRLE1BQVIsR0FBaUIsUUFBakIsQ0FBMEIsUUFBMUI7QUFDQSxnQkFBUSxFQUFFLElBQUYsRUFBUSxJQUFSLENBQWEsTUFBYixFQUFxQixLQUFyQixDQUEyQixPQUEzQixFQUFvQyxDQUFwQyxDQUFSO0FBQ0EsVUFBRSxjQUFGO0FBQ0gsS0FORDtBQU9ILENBUkQ7O0FBVUEsU0FBUyxPQUFULENBQWlCLElBQWpCLEVBQXVCO0FBQ25CLE1BQUUsSUFBRixDQUFPO0FBQ0gsYUFBTSxXQUFXLElBRGQ7QUFFSCxrQkFBVTtBQUZQLEtBQVAsRUFHRyxJQUhILENBR1EsVUFBVSxHQUFWLEVBQWU7QUFDbkIsYUFBSyxVQUFMLENBQWdCLEdBQWhCO0FBQ0gsS0FMRCxFQUtHLElBTEgsQ0FLUSxZQUFZO0FBQ2hCLGNBQU0sNEJBQU47QUFDSCxLQVBEO0FBUUgiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXHJcblxyXG5jbGFzcyBUb2RvIHtcclxuXHJcbiAgICB1cGRhdGUoaWQpIHtcclxuXHJcbiAgICAgICAgbGV0IGZvcm0gPSAkKGAjdGFza19mb3JtXyR7aWR9YCk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSAkLmFqYXgoe3VybDogJ3RvZG8vJyArIGlkLCB0eXBlOiAncGF0Y2gnLCBkYXRhOiBmb3JtLnNlcmlhbGl6ZSgpfSk7XHJcblxyXG4gICAgICAgIHJlcXVlc3QuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAkKGAjdGFza19zcGFuXyR7aWR9YCkuaHRtbChyZXMudGFzayk7XHJcbiAgICAgICAgICAgICQoJyN2aWV3XycgKyBpZCkuc2hvdygpO1xyXG4gICAgICAgICAgICAkKCcjZWRpdF8nICsgaWQpLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGVkaXRDYW5jZWwoaWQpIHtcclxuICAgICAgICBsZXQgdGV4dCA9ICQoJyN0YXNrX3NwYW5fJyArIGlkKS5odG1sKCk7XHJcbiAgICAgICAgJChgI3Rhc2tfaW5wdXRfJHtpZH1gKS52YWwodGV4dC50cmltKCkpO1xyXG4gICAgICAgICQoJyNlZGl0XycgKyBpZCkuaGlkZSgpO1xyXG4gICAgICAgICQoJyN2aWV3XycgKyBpZCkuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXQoaWQpIHtcclxuICAgICAgICBsZXQgdGV4dCA9ICQoJyN0YXNrX3NwYW5fJyArIGlkKS5odG1sKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0Fsb2hhIScpO1xyXG4gICAgICAgICQoJyN2aWV3XycgKyBpZCkuaGlkZSgpO1xyXG4gICAgICAgICQoJyNlZGl0XycgKyBpZCkuc2hvdygpO1xyXG4gICAgICAgICQoYCN0YXNrX2lucHV0XyR7aWR9YCkudmFsKHRleHQudHJpbSgpKS5zZWxlY3QoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlQ2FuY2VsKCkge1xyXG4gICAgICAgICQoJyN0YXNrXzAnKS5yZW1vdmUoKTtcclxuICAgICAgICAkKCcudGFzay1jcmVhdGUnKS5zaG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlKCkge1xyXG4gICAgICAgICQoJy50YXNrLWNyZWF0ZS1jYW5jZWwnKS5zaG93KCk7XHJcblxyXG4gICAgICAgIGxldCB0b2tlbiA9ICQoJyNfdG9rZW4nKS52YWwoKTtcclxuXHJcbiAgICAgICAgbGV0IGxpID0gYDxsaSBpZD1cInRhc2tfMFwiIGNsYXNzPVwiY29sbGVjdGlvbi1pdGVtXCI+ICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiZWRpdF8wXCIgY2xhc3M9XCJlZGl0LW1vZGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGZvcm0gaWQ9XCJ0YXNrX2Zvcm1fMFwiIGNsYXNzPVwiY29sIHMxMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiX3Rva2VuXCIgdmFsdWU9XCIke3Rva2VufVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInJvd1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dC1maWVsZCBjb2wgczEwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBwbGFjZWhvbGRlcj1cIkVudGVyIHRhc2sgbmFtZVwiIGlkPVwidGFza19pbnB1dF8wXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ2YWxpZGF0ZVwiIG5hbWU9XCJ0YXNrXCIgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXNrLWlkPVwiMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wgczJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwic2Vjb25kYXJ5LWNvbnRlbnQgdGFzay1zdG9yZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIjBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwibWVkaXVtIG1hdGVyaWFsLWljb25zXCI+ZG9uZTwvaT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9saT5gO1xyXG5cclxuXHJcbiAgICAgICAgJCgnI3RvZG8tbGlzdCcpLmFwcGVuZChsaSk7XHJcbiAgICAgICAgJCgnI3Rhc2tfMCcpLmZpbmQoJyN0YXNrX2lucHV0XzAnKS5mb2N1cygpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdG9yZSgpIHtcclxuICAgICAgICBsZXQgZm9ybSA9ICQoJyN0YXNrX2Zvcm1fMCcpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gJC5hamF4KHt1cmw6ICd0b2RvJywgdHlwZTogJ3Bvc3QnLCBkYXRhOiBmb3JtLnNlcmlhbGl6ZSgpfSk7XHJcblxyXG4gICAgICAgIHJlcXVlc3QuZG9uZShmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuXHJcbiAgICAgICAgICAgIC8qbGV0IHRhc2sgPSAkKCcjdGFza18wJyk7XHJcbiAgICAgICAgICAgIGxldCB0b2tlbiA9ICQoJyNfdG9rZW4nKS52YWwoKTtcclxuICAgICAgICAgICAgdGFzay5yZW1vdmUoKTsqL1xyXG5cclxuICAgICAgICAgICAgLypsZXQgbGkgPSBgPGxpIGlkPVwidGFza18ke3Jlcy5pZH1cIiBjbGFzcz1cImNvbGxlY3Rpb24taXRlbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJ2aWV3XyR7cmVzLmlkfVwiIGNsYXNzPVwidmlldy1tb2RlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGlkPVwidGFza19zcGFuXyR7cmVzLmlkfVwiPiR7cmVzLnRhc2t9PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwic2Vjb25kYXJ5LWNvbnRlbnQgdGFzay1kZWxldGUtZGlhbG9nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWQtdGV4dCB0ZXh0LWFjY2VudC0yXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXNrLWlkPVwiJHtyZXMuaWR9XCIgdGl0bGU9XCJEZWxldGUgVGFza1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmRlbGV0ZTwvaT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwic2Vjb25kYXJ5LWNvbnRlbnQgdGFzay1lZGl0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXNrLWlkPVwiJHtyZXMuaWR9XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+bW9kZV9lZGl0PC9pPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cImVkaXRfJHtyZXMuaWR9XCIgY2xhc3M9XCJlZGl0LW1vZGVcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGZvcm0gaWQ9XCJ0YXNrX2Zvcm1fJHtyZXMuaWR9XCIgY2xhc3M9XCJjb2wgczEwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJfdG9rZW5cIiB2YWx1ZT1cIiR7dG9rZW59XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicm93XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWZpZWxkIGNvbCBzMTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHBsYWNlaG9sZGVyPVwiRW50ZXIgdGFzayBuYW1lXCIgaWQ9XCJ0YXNrX2lucHV0XyR7cmVzLmlkfVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiIGNsYXNzPVwidmFsaWRhdGVcIiBuYW1lPVwidGFza1wiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXNrLWlkPVwiJHtyZXMuaWR9XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbCBzMlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJzZWNvbmRhcnktY29udGVudCB0YXNrLXVwZGF0ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGFzay1pZD1cIiR7cmVzLmlkfVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtZWRpdW0gbWF0ZXJpYWwtaWNvbnNcIj5kb25lPC9pPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2xpPmA7XHJcblxyXG4gICAgICAgICAgICBsZXQgbGlzdCA9ICQoJyN0b2RvLWxpc3QnKTtcclxuXHJcbiAgICAgICAgICAgIGxpc3QuZmluZCgnbGk6ZXEoMCknKS5hZnRlcihsaSk7XHJcblxyXG4gICAgICAgICAgICBpZiAobGlzdC5maW5kKCdsaScpLmxlbmd0aCA9PSA5KSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0LmZpbmQoJ2xpJykubGFzdCgpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkKCcudGFzay1jcmVhdGUtY2FuY2VsJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKCcudGFzay1jcmVhdGUnKS5zaG93KCk7Ki9cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVEaWFsb2coaWQpIHtcclxuICAgICAgICBsZXQgbW9kYWwgPSAkKCcjbW9kYWwtdGFzay1kZWxldGUnKTtcclxuICAgICAgICBsZXQgdGFzayA9ICQoYCN0YXNrX3NwYW5fJHtpZH1gKTtcclxuXHJcbiAgICAgICAgJChgI3Rhc2tfJHtpZH1gKS5hZGRDbGFzcygncmVkIGFjY2VudC0xJyk7XHJcblxyXG4gICAgICAgIG1vZGFsLmRhdGEoJ3RhcmdldC1pZCcsIGlkKTtcclxuXHJcbiAgICAgICAgbW9kYWwuZmluZCgnI3Rhc2stdG8tZGVsZXRlLXRleHQnKS5odG1sKHRhc2suaHRtbCgpLnRyaW0oKSk7XHJcbiAgICAgICAgbW9kYWwub3Blbk1vZGFsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FuY2VsKCkge1xyXG4gICAgICAgIGxldCBtb2RhbCA9ICQoJyNtb2RhbC10YXNrLWRlbGV0ZScpO1xyXG4gICAgICAgIGxldCBpZCA9IG1vZGFsLmRhdGEoJ3RhcmdldC1pZCcpO1xyXG4gICAgICAgICQoYCN0YXNrXyR7aWR9YCkucmVtb3ZlQ2xhc3MoJ3JlZCBhY2NlbnQtMScpO1xyXG4gICAgICAgIG1vZGFsLmNsb3NlTW9kYWwoKTtcclxuXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRlbGV0ZSgpIHtcclxuICAgICAgICBsZXQgbW9kYWwgPSAkKCcjbW9kYWwtdGFzay1kZWxldGUnKTtcclxuICAgICAgICBsZXQgaWQgPSBtb2RhbC5kYXRhKCd0YXJnZXQtaWQnKTtcclxuICAgICAgICBsZXQgcmVxdWVzdCA9ICQuYWpheCh7dXJsOiBgdG9kby8ke2lkfWAsIHR5cGU6ICdkZWxldGUnLCBkYXRhOiB7X3Rva2VuOiAkKCcjX3Rva2VuJykudmFsKCl9fSk7XHJcbiAgICAgICAgcmVxdWVzdC5kb25lKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclRvZG8ocmVzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3JlbmRlcicpO1xyXG4gICAgICAgIGxldCBsaXN0ID0gJCgnI3RvZG8tbGlzdCcpO1xyXG4gICAgICAgIGxldCBjb2xsZWN0aW9uID0gbGlzdC5maW5kKCdsaTplcSgwKScpLnByb3AoJ291dGVySFRNTCcpO1xyXG4gICAgICAgIGxpc3QuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSBpbiByZXMuZGF0YSkge1xyXG4gICAgICAgICAgICBjb2xsZWN0aW9uICs9IHRoaXMubGkocmVzLmRhdGFbaV0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGlzdC5hcHBlbmQoY29sbGVjdGlvbik7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJQYWdpbmF0aW9uKHJlcylcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJQYWdpbmF0aW9uKHJlcykge1xyXG4gICAgICAgIGxldCBwYWdpbmF0aW9uID0gJyc7XHJcbiAgICAgICAgbGV0IGNvbnRhaW5lciA9ICQoJy5wYWdpbmF0aW9uJyk7XHJcbiAgICAgICAgbGV0IHVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdDtcclxuXHJcbiAgICAgICAgbGV0IHByZXYgPSAocmVzLnByZXZfcGFnZV91cmwgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYDxsaT48c3Bhbj4gPDwgPC9zcGFuPjwvbGk+YFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGA8bGk+PGEgaHJlZj1cIiR7cmVzLnByZXZfcGFnZV91cmx9XCI+IDw8IDwvYT48L2xpPmA7XHJcblxyXG4gICAgICAgIGxldCBuZXh0ID0gKHJlcy5uZXh0X3BhZ2VfdXJsID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGA8bGk+PHNwYW4+ID4+IDwvc3Bhbj48L2xpPmBcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBgPGxpPjxhIGhyZWY9XCIke3Jlcy5uZXh0X3BhZ2VfdXJsfVwiPiA+PiA8L2E+PC9saT5gO1xyXG5cclxuICAgICAgICBwYWdpbmF0aW9uICs9IHByZXY7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHJlcy5sYXN0X3BhZ2U7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgbGV0IGxpID0gYDxsaT48YSBocmVmPVwiJHt1cmx9P3BhZ2U9JHtpfVwiID4ke2l9PC9hPjwvbGk+YDtcclxuXHJcbiAgICAgICAgICAgIGlmIChyZXMuY3VycmVudF9wYWdlID09IGkpIHtcclxuICAgICAgICAgICAgICAgIGxpID0gYDxsaSBjbGFzcz1cImFjdGl2ZVwiPjxzcGFuIGNsYXNzPVwiYWN0aXZlXCI+JHtpfTwvc3Bhbj48L2xpPmA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHBhZ2luYXRpb24gKz0gbGk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwYWdpbmF0aW9uICs9IG5leHQ7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBDdXJyZW50IHBhZ2U6ICR7cmVzLmN1cnJlbnRfcGFnZX1gKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyLmVtcHR5KCkuYXBwZW5kKHBhZ2luYXRpb24pO1xyXG5cclxuICAgICAgICAvKmNvbnRhaW5lci5wcmVwZW5kKGA8bGk+PHNwYW4+IDw8IDwvc3Bhbj48L2xpPmApO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQoYDxsaT48c3Bhbj4gPj4gPC9zcGFuPjwvbGk+YCk7Ki9cclxuICAgIH1cclxuICAgIFxyXG4gICAgbGkgKHJlcykge1xyXG4gICAgICAgIGxldCB0b2tlbiA9ICQoJyNfdG9rZW4nKS52YWwoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGA8bGkgaWQ9XCJ0YXNrXyR7cmVzLmlkfVwiIGNsYXNzPVwiY29sbGVjdGlvbi1pdGVtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cInZpZXdfJHtyZXMuaWR9XCIgY2xhc3M9XCJ2aWV3LW1vZGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gaWQ9XCJ0YXNrX3NwYW5fJHtyZXMuaWR9XCI+JHtyZXMudGFza308L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJzZWNvbmRhcnktY29udGVudCB0YXNrLWRlbGV0ZS1kaWFsb2dcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZC10ZXh0IHRleHQtYWNjZW50LTJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRhc2staWQ9XCIke3Jlcy5pZH1cIiB0aXRsZT1cIkRlbGV0ZSBUYXNrXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+ZGVsZXRlPC9pPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJzZWNvbmRhcnktY29udGVudCB0YXNrLWVkaXRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRhc2staWQ9XCIke3Jlcy5pZH1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5tb2RlX2VkaXQ8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiZWRpdF8ke3Jlcy5pZH1cIiBjbGFzcz1cImVkaXQtbW9kZVwiIHN0eWxlPVwiZGlzcGxheTogbm9uZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8Zm9ybSBpZD1cInRhc2tfZm9ybV8ke3Jlcy5pZH1cIiBjbGFzcz1cImNvbCBzMTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIl90b2tlblwiIHZhbHVlPVwiJHt0b2tlbn1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZmllbGQgY29sIHMxMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgcGxhY2Vob2xkZXI9XCJFbnRlciB0YXNrIG5hbWVcIiBpZD1cInRhc2tfaW5wdXRfJHtyZXMuaWR9XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ2YWxpZGF0ZVwiIG5hbWU9XCJ0YXNrXCIgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRhc2staWQ9XCIke3Jlcy5pZH1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sIHMyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBjbGFzcz1cInNlY29uZGFyeS1jb250ZW50IHRhc2stdXBkYXRlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXNrLWlkPVwiJHtyZXMuaWR9XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1lZGl1bSBtYXRlcmlhbC1pY29uc1wiPmRvbmU8L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvbGk+YDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IFRvZG87IiwiLy8kKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5zaWRlTmF2KCk7XHJcblxyXG52YXIgVG9kbyA9IHJlcXVpcmUoJy4uL2NvbXBvbmVudHMvVG9kbycpO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLWNyZWF0ZScsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ2NyZWF0ZScpO1xyXG4gICAgJCgnLnRhc2stY3JlYXRlJykuaGlkZSgpO1xyXG4gICAgVG9kby5jcmVhdGUoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stY3JlYXRlLWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ3Rhc2stY3JlYXRlLWNhbmNlbCcpO1xyXG4gICAgJCgnLnRhc2stY3JlYXRlLWNhbmNlbCcpLmhpZGUoKTtcclxuICAgIFRvZG8uY3JlYXRlQ2FuY2VsKCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLXN0b3JlJywgZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZygnY3JlYXRlJyk7XHJcbiAgICBUb2RvLnN0b3JlKCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oXCJrZXlwcmVzc1wiLCBcImlucHV0XCIsIGZ1bmN0aW9uKGUpIHtcclxuXHJcblxyXG4gICAgaWYgKGUua2V5Q29kZSA9PSAxMykge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBsZXQgaWQgPSAkKHRoaXMpLmRhdGEoJ3Rhc2staWQnKTtcclxuXHJcbiAgICAgICAgaWYgKCQoJyN0YXNrXzAnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJIENvdWxkIGRpZSBmb3IgeW91Jyk7XHJcblxyXG4gICAgICAgICAgICBUb2RvLnN0b3JlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgVG9kby51cGRhdGUoaWQpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbn0pO1xyXG5cclxuXHJcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudGFzay1lZGl0JywgZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZygnZWRpdCcpO1xyXG4gICAgbGV0IGlkID0gJCh0aGlzKS5kYXRhKCd0YXNrLWlkJyk7XHJcbiAgICBUb2RvLmVkaXQoaWQpO1xyXG59KTtcclxuXHJcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudGFzay1lZGl0LWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ2VkaXQtY2FuY2VsJyk7XHJcbiAgICBsZXQgaWQgPSAkKHRoaXMpLmRhdGEoJ3Rhc2staWQnKTtcclxuICAgIFRvZG8uZWRpdENhbmNlbChpZCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLXVwZGF0ZScsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc29sZS5sb2coJ3VwZGF0ZScpO1xyXG4gICAgbGV0IGlkID0gJCh0aGlzKS5kYXRhKCd0YXNrLWlkJyk7XHJcbiAgICBUb2RvLnVwZGF0ZShpZCk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50YXNrLWRlbGV0ZS1kaWFsb2cnLCBmdW5jdGlvbihlKXtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnNvbGUubG9nKCdkZWxldGUtZGlhbG9nJyk7XHJcbiAgICBsZXQgaWQgPSAkKHRoaXMpLmRhdGEoJ3Rhc2staWQnKTtcclxuICAgIFRvZG8uZGVsZXRlRGlhbG9nKGlkKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stZGVsZXRlLWNhbmNlbCcsIGZ1bmN0aW9uKGUpe1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgVG9kby5kZWxldGVDYW5jZWwoKTtcclxufSk7XHJcblxyXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnRhc2stZGVsZXRlJywgZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZygnZGVsZXRlJyk7XHJcbiAgICBUb2RvLmRlbGV0ZSgpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcbiAgICAkKCdtYWluJykub24oJ2NsaWNrJywgJy5wYWdpbmF0aW9uIGEnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICQoJy5wYWdpbmF0aW9uJykuZmluZCgnbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlIGRpc2FibGVkJyk7XHJcblxyXG4gICAgICAgICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIGdldFRvZG8oJCh0aGlzKS5hdHRyKCdocmVmJykuc3BsaXQoJ3BhZ2U9JylbMV0pO1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGdldFRvZG8ocGFnZSkge1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgICB1cmwgOiAnP3BhZ2U9JyArIHBhZ2UsXHJcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgfSkuZG9uZShmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgVG9kby5yZW5kZXJUb2RvKHJlcyk7XHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhbGVydCgnUG9zdHMgY291bGQgbm90IGJlIGxvYWRlZC4nKTtcclxuICAgIH0pO1xyXG59XHJcbiJdfQ==
